<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>History Manager</title>
	<link rel="stylesheet" href="assets/css/style.css">
	<script src="node_modules/handsontable/dist/handsontable.full.js"></script>
	<link rel="stylesheet" media="screen" href="node_modules/handsontable/dist/handsontable.full.css">
	<script type="text/javascript" src="node_modules/handsontable/dist/languages/all.js"></script>
</head>
<body>
	<div id="hot"></div>
<script>
const C = Handsontable.languages.dictionaryKeys;
	var dataObject = [
  {
    id: 1,
    label: 'Internet Explorer ne marche pas',
    client: 'Josie de la compta',
    phone: '06.94.65.45.98',
    intervener: 'Remi Fontaine',
    mail: 'rfontaine@intech.fr',
    process: 'OS reinstallation',
    status: 'Done',
    date: '24/03/2018',
    price: '75.00€'
  }
];
var currencyCodes = ['EUR', 'JPY', 'GBP', 'CHF', 'CAD', 'AUD', 'NZD', 'SEK', 'NOK', 'BRL', 'CNY', 'RUB', 'INR', 'TRY', 'THB', 'IDR', 'MYR', 'MXN', 'ARS', 'DKK', 'ILS', 'PHP'];
var flagRenderer = function (instance, td, row, col, prop, value, cellProperties) {
  var currencyCode = value;
  while (td.firstChild) {
    td.removeChild(td.firstChild);
  }
  if (currencyCodes.indexOf(currencyCode) > -1) {
    var flagElement = document.createElement('DIV');

    flagElement.className = 'flag ' + currencyCode.toLowerCase();
    td.appendChild(flagElement);
  } else {
    var textNode = document.createTextNode(value === null ? '' : value);

    td.appendChild(textNode);
  }
};
var hotElement = document.querySelector('#hot');
var hotElementContainer = hotElement.parentNode;
var hotSettings = {
  data: dataObject,
  language: 'fr-FR',
  columns: [
    {
      data: 'id',
      type: 'numeric'
    },
    {
      data: 'label',
      type: 'text'
    },
    {
      data: 'client',
      type: 'text'
    },
    {
      data: 'phone',
      type: 'numeric'
    },
    {
      data: 'intervener',
      type: 'text'
    },
    {
      data: 'mail',
      type: 'text'
    },
    {
      data: 'process',
      type: 'text'
    },
    {
    	data: 'status',
    	type: 'text'
    },
    {
      data: 'date',
      type: 'date',
      dateFormat: 'MM/DD/YYYY'
    },
    {
    	data: 'price',
    	type: 'numeric',
    	numericFormat: {
    		pattern: '0,00€'
    	}

    }
  ],
  stretchH: 'all',
  width: '100%',
  autoWrapRow: true,
  height: 487,
  maxRows: 22,
  rowHeaders: true,
  colHeaders: [
    'ID',
    'Label',
    'Client',
    'Phone',
    'Intervener',
    'Mail',
    'Process',
    'Status',
    'Date',
    'Price'
  ],
  columnSorting: true,
  sortIndicator: true,
  autoColumnSize: {
    samplingRatio: 23
  },
  manualRowResize: true,
  manualColumnResize: true,
  contextMenu: true
};
var hot = new Handsontable(hotElement, hotSettings);
</script>
</body>
</html>